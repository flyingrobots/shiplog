# Shiplog v0.2.0 â€“ The Cut of Your Jib

Raise the colors and man the riggingâ€”this release outfits Shiplog with fresh gear for wrapping commands, steering automation, and reading the trust roster without leaving the quarterdeck.

## ğŸ´â€â˜ ï¸ Highlights

### ğŸªµ Command Wrapper â€” `git shiplog run`
Wrap any command, capture stdout/stderr, and record structured run metadata directly in your journal. Shiplog even attaches the command output as a Git note when there is something to read back later.

```bash
$ git shiplog run \
    --service deploy \
    --reason "Smoke test" \
    --region us-west-2 \
    --cluster prod-a \
    --namespace frontend \
    -- env printf hi
hi
Deploy: deploy <none> â†’ prod/us-west-2/prod-a/frontend
Reason: Smoke test
Status: SUCCESS (0s) @ 2025-09-30T02:14:18Z
Seq:    7 (parent 1f6d81d, trust 217be22, anchor (none))
```

The trailer now contains a `run` object describing the invocation:

```bash
$ git shiplog show --json | jq '.run'
{
  "argv": ["env", "printf", "hi"],
  "cmd": "env printf hi",
  "exit_code": 0,
  "status": "success",
  "duration_s": 0,
  "started_at": "2025-09-30T02:14:18Z",
  "finished_at": "2025-09-30T02:14:18Z",
  "log_attached": true
}
```

### ğŸ¤– Automation-Friendly Append â€” `git shiplog append`
Post entries non-interactively via JSON payloadsâ€”no prompts, no environment juggling. Pipe structured data from stdin or point to a file and Shiplog merges it into the trailer.

```bash
$ printf '{"checks":{"canary":"green"}}' \
    | git shiplog append \
        --env prod \
        --service deploy \
        --status success \
        --reason "Post-release smoke" \
        --json -
Deploy: deploy <none> â†’ prod/?/?/prod
Reason: Post-release smoke
Status: SUCCESS (0s) @ 2025-09-30T02:18:50Z
```

```bash
$ git shiplog show --json | jq '{status, why, checks}'
{
  "status": "success",
  "why": {
    "reason": "Post-release smoke",
    "ticket": null
  },
  "checks": {
    "canary": "green"
  }
}
```

### ğŸ¤ Trust Roster View â€” `git shiplog trust show`
Inspect the current trust contract and signer inventory straight from the CLI. Use `--json` for raw consumption or enjoy a bosun-approved table.

```bash
$ git shiplog trust show
Trust ID: shiplog-trust-root
Threshold: 1
Allowed signers: 1
Maintainers:
  - Shiplog Tester <shiplog-tester@example.com> [root]
Signers:
  - shiplog-tester@example.com (ssh-ed25519)
```

```bash
$ git shiplog trust show --json | jq '{id, threshold, maintainers}'
{
  "id": "shiplog-trust-root",
  "threshold": 1,
  "maintainers": [
    {
      "name": "Shiplog Tester",
      "email": "shiplog-tester@example.com",
      "role": "root",
      "revoked": false
    }
  ]
}
```

### ğŸ“‹ Structured Entry Schema â€” `docs/reference/json-schema.md`
Weâ€™ve published the JSON Schema for Shiplog trailers (including the new `run` payload). No more guessing field names or status enumsâ€”downstream tooling can validate entries with confidence.

---

## âš“ Upgrade Notes

- No breaking changes; existing journals remain seaworthy.
- `git shiplog run` and `git shiplog append` now populate `SHIPLOG_EXTRA_JSON` internally. Hook authors should merge additional data rather than overwriting the trailer.
- Namespace defaults to the journal name when `SHIPLOG_NAMESPACE` is unset (writing to "staging" now records `namespace="staging"`).

---

## ğŸ§­ Thanks

Thanks to @coderabbitai for sharp-eyed reviews and to the crews running our Dockerized Bats matrixâ€”your watch kept this release shipshape.

Hoist v0.2.0 and log your next maneuverâ€”Shiplog will keep the journal true, steady on the bearing, and faithful even when the seas get rough.
